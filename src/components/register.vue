<template>
  <div class="login_container">
    <div class="login_logo">
      <img src="../assets/login/logo.png" alt />
    </div>
    <div class="login_box">
      <div class="login_box_1">
        <img src="../assets/login/pic01.jpg" alt />
      </div>
      <div class="login_box_2">
        <img src="../assets/login/wel.png" alt />
        <div class="table">
          <table>
            <tr>
              <td>ç”¨æˆ·å:</td>
              <td>
                <input type="text" placeholder="Wacomè´¦å·" v-model="username" @blur="find" @focus="input"/><span v-show="flag == true">{{message}}</span>
              </td>
            </tr>
            <tr>
              <td>é‚®ç®±</td>
              <td>
                <input type="email" placeholder="è¯·è¾“å…¥é‚®ç®±" v-model="email" @blur="emails" @focus="input"/><span v-show="flag_email == true">{{message}}</span>
              </td>
            </tr>
            <tr>
              <td>å¯†ç </td>
              <td>
                <input type="password" placeholder="å¯†ç (9-32ä½å­—ç¬¦)" v-model="password" @blur="userpass" @focus="input"/><span v-show="flag_password == true">{{message}}</span>
              </td>
            </tr>
            <tr>
              <td>ç¡®è®¤å¯†ç </td>
              <td>
                <input type="password" placeholder="ç¡®è®¤å¯†ç (9-32ä½å­—ç¬¦)" v-model="password_2" @blur="userpass_2"  @focus="input"/><span v-show="flag_password_2 == true">{{message}}</span>
              </td>
            </tr>
            <tr>
              <td colspan="2">
                <input type="checkbox" v-model="checked_1" />è¯·å‹¾é€‰è¿™é‡Œä»¥è¡¨ç¤ºæ‚¨å·²é˜…è¯»å¹¶åŒæ„Wacomçš„
                <a href="#">éšç§æ”¿ç­–</a>ã€‚å’Œ
                <a href="#">Cookieé€šçŸ¥</a>ã€‚
                <br />
                <input type="checkbox" v-model="checked_2" />è¯·å‹¾é€‰è¿™é‡Œä»¥è¡¨ç¤ºæ‚¨å·²é˜…è¯»å¹¶åŒæ„Wacomçš„
                <a href="#">ä½¿ç”¨æ¡æ¬¾</a>ã€‚
                <br />
                <input type="checkbox" v-model="checked_3" />
                æ˜¯çš„ï¼Œæˆ‘åŒæ„æ¥æ”¶æ¥è‡ªWacomçš„é‚®ä»¶ä¿¡æ¯ï¼Œä»¥ä¾¿äº†è§£æ›´å¤šå…³äºWacomå…¬å¸ã€äº§å“ã€æ–°é—»ã€æ´»åŠ¨ã€æœåŠ¡ä»¥åŠæ›´å¤šWacomå®˜æ–¹å•†åŸçš„ä¿ƒé”€ä¿¡æ¯ç­‰ã€‚æˆ‘çŸ¥æ™“æˆ‘å¯ä»¥éšæ—¶å–æ¶ˆè®¢é˜…é‚®ä»¶ä¿¡æ¯ã€‚
              </td>
            </tr>
            <tr>
              <td>
                <div class="btn">
                  <el-button
                    type="primary"
                    style="width:150px;font-size:24px;background-color:#02A7E0"
                    @click="action"
                  >æ³¨å†Œ</el-button>
                </div>
              </td>
              <td></td>
            </tr>
          </table>
        </div>

        <div class="login_footer">
          <p>
            æ‚¨å·²ç»æ˜¯Wacomè´¦å·ç”¨æˆ·ï¼Œç«‹å³
            <a href="#">ç™»å½•</a>
          </p>
        </div>
      </div>
    </div>
    <div class="login_bottom">
      <a href="#">ä½¿ç”¨æ¡æ¬¾</a>
      <a href="#">éšç§æ¡æ¬¾</a>
      <a href="#">Cookie Notice</a>
      <p>Copyright Â© 2018 estore.wacom.com.cn å’Œå† ç§‘æŠ€ï¼ˆåŒ—äº¬ï¼‰æœ‰é™å…¬å¸All Rights Reserved. äº¬ICPå¤‡13037713å·</p>
      <p>ä¸ºäº†ç»™æ‚¨æä¾›æ›´å¥½çš„è´­ç‰©ä½“éªŒï¼Œæ¨èä½¿ç”¨è°·æ­Œã€360æ€¥é€Ÿã€IE10åŠä»¥ä¸Šç‰ˆæœ¬æµè§ˆå™¨è®¿é—®æœ¬å•†åŸã€‚</p>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      username: '',
      password: '',
      email: '',
      password_2: '',
      checked_1: false,
      checked_2: false,
      checked_3: false,
      // è´¦å·éªŒè¯çŠ¶æ€
      flag: false,
      // é‚®ç®±éªŒè¯çŠ¶æ€
      flag_email: false,
      // å¯†ç éªŒè¯
      flag_password: false,
      flag_password_2: false,
      message: 'ğŸ‘†ä¸èƒ½ä¸ºç©º'
    };
  },
  methods: {
    action() {
      if(this.checked_1 && this.checked_2 && this.checked_3){
        let username = this.username;
        let password = this.password;
        let email = this.email;
        let password_2 = this.password_2;
        console.log(`this.findçš„ç»“æœä¸º${this.find()}`);
        if(password == password_2){
          // console.log(this.find());
          if(this.find() !=false && this.flag == false && this.emails() != false && this. userpass() != false && this. userpass_2() != false){
            // window.alert('ok');
            this.axios.post('/registers','username=' + this.username + '&password=' + this.password + '&email=' + this.email).then(res=>{
              if(res.data.code == 0){
                window.alert('åˆ›å»ºå¤±è´¥');
              }else{
                this.$router.push('/login');
              }
            })
            
          }
        }
      }else{
        window.alert('è¯·ç¡®è®¤åè®®æ˜¯å¦èµåŒ');
      }
      

      // console.log();
      },
      // è´¦å·éªŒè¯
      find(){
        this.message = 'ğŸ‘†ä¸èƒ½ä¸ºç©º';
        let username = this.username;
        // console.log(username.length);
        let regExp_username = /^\w{7,25}$/;
        let uname = regExp_username.test(username);
        // console.log(uname);
        if(!uname) {
          this.flag = true;
          if(this.username.length != 0){
            if(this.username.length <7 || this.username.length > 25)
            this.message = 'ç”¨æˆ·åé•¿åº¦åœ¨7-25ä½';
            return false;
          }
          return false;
        }
        if(uname){
          this.message = 'ğŸ‘†ä¸èƒ½ä¸ºç©º';
          this.axios.get('/register?username=' + this.username).then(res=>{
            console.log(res.data);
            if(res.data == 0) {
              this.message = 'ç”¨æˆ·åå·²å­˜åœ¨';
              this.flag = true;
              return false;
            }else {
              return true;
            }
          });
          
        }
      },
      // é‚®ç®±éªŒè¯
      emails(){
        let email = this.email;
        let regExp_email = /^\w+@[0-9A-Za-z]+.com$/;
        let flag_emails = regExp_email.test(email);
        // console.log(flag_emails);
        if(!flag_emails){
          this.message = 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®';
          this.flag_email = true;
          return false;
        }else {
          return true;
        }
      },
      // å¯†ç éªŒè¯
      userpass(){
        let regExp_password = /^[0-9A-Za-z_]{8,25}$/;
        let flag_passwords = regExp_password.test(this.password);
        if(flag_passwords){
          return true;
        }else{
          this.flag_password = true;
          this.message = 'å¯†ç æ ¼å¼ä¸æ­£ç¡®';
          return false;
        }
      },
      // å¯†ç é‡å¤éªŒè¯
      userpass_2(){
        let password = this.password;
        let password_2 = this.password_2; 
        if(password == password_2){
          return true;
        }else{
          this.flag_password_2 = true;
          this.message = 'ä¸¤æ¬¡å¯†ç ä¸ä¸€è‡´';
          return false;
        };
      },
      // è·å–ç„¦ç‚¹äº‹ä»¶
      input(){
        this.flag = false;
        this.flag_password = false;
        this.flag_password_2 = false;
        this.flag_email = false;
      }
    }
  }

</script>


<style scoped>
.login_container {
  background-color: rgb(244, 244, 244);
  height: 100%;
}
.login_container:before {
  content: "";
  display: table;
}
.login_box {
  display: flex;
  justify-content: center;
}
.login_box_2 {
  width: 385px;
  height: 550px;
  padding: 64px 28px 0 50px;
  font-size: 12px;
  overflow: hidden;
  background: url(../assets/login/shadow.gif) no-repeat left top;
  background-color: #fff;
  /* border: 1px solid red; */
  text-align: left;
}
.login_box_2 > img {
  margin-bottom: 20px;
}
/* è¡¨æ ¼å±æ€§ */
.table {
  font-family: Arial, "å®‹ä½“", Helvetica, sans-serif;
  font-size: 22px;
}
div.table > table > tr:not(:last-child) {
  height: 50px;
}
div.table > table > tr:nth-child(5) {
  font-size: 12px;
  line-height: 18px;
}
div.table > table > tr:nth-child(5) input {
  width: 12px;
  height: 12px;
}
div.table > table > tr:nth-child(5) a {
  color: #02a7e0;
}
div.table > table > tr > td > input {
  height: 32px;
  width: 170px;
}
div.table > table > tr > td {
  position: relative;
}
div.table > table > tr > td > span {
  display: inline-block;
  position: absolute;
  background-color: #B94A48;
  width: 120px;
  height: 30px;
  text-align: center;
  padding-top: 10px;
  font: 12px/16px Arial, 'å®‹ä½“', Helvetica, sans-serif; 
  top: 75%;
  left: 0%;
  z-index: 20;
}
.login_box_2 a {
  text-decoration: none;
  color: #666666;
}
.login_logo {
  width: 1002px;
  height: 116px;
  /* border: 1px solid red; */
  margin: 0 auto;
}
.login_logo > img {
  padding: 32px 0 0 65px;
}
.form_1 {
  display: flex;
}
.btn {
  padding: 18px 0 30px 0;
  border-bottom: 1px solid #dcdcdc;
}
.login_footer {
  margin: 18px 0 0 0px;
}
.login_footer > p > a {
  font-size: 21px;
  color: #ff6000;
}
.login_bottom {
  padding-top: 35px;
  width: 1200px;
  margin: 30px auto;
  text-align: center;
  line-height: 30px;
  border-top: 1px solid #dcdcdc;
}
.login_bottom a {
  text-decoration: none;
  margin: 0 5px 0;
  color: #02a7e0;
}
</style>